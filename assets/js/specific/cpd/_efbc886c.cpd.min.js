!function(a){a(document).ready(function(){function b(){m.val(""),n.val(""),a("#cpd_date_from").val(""),a("#cpd_date_to").val(""),m.closest(".form-field").find(".alert").remove()}function c(a){a?q.removeClass("hide"):q.addClass("hide")}var d,e,f,g=cfrequest.resultEndpoint,h=cfrequest.chartEndpoint,i=a(cfrequest.resultsContainer),j=a("body"),k=a("#download-report-link"),l=a("#cpd_date_range"),m=a("input[name='cpd_date_to']"),n=a("input[name='cpd_date_from']"),o=cfrequest.downloadReportEndpoint,p=a(cfrequest.chartContainer),q=a(".resource-loader");updateURL=function(a){var b=[location.protocol,"//",location.host,location.pathname].join(""),c=o,d=!0;for(var e in a)a[e].length&&(d?(b+="?",c+="?",d=!1):(b+="&",c+="&"),b+=e+"="+a[e],c+=e+"="+a[e]);k.attr("href",c),window.history.pushState({path:b},"",b)},e=function(){var b={},c={};a(".filter-checkbox:checked").each(function(){var b=a(this).attr("name");void 0===c[b]&&(c[b]=[]),c[b].push(a(this).val())});for(var d in c)b[d]=c[d].toString();return b.maxRows=cfrequest.maxRows,a(".related-filter-field").each(function(){if(a(this).length){var c=a(this).attr("name");b[c]=a(this).val()}}),m.length&&(b.cpd_date_to=m.val()),n.length&&(b.cpd_date_from=n.val()),updateURL(b),b.pageId=cfrequest.pageId,b},d=function(){c(!0);var b=e();console.log(b),a.ajax(g,{method:"POST",cache:!1,data:b}).done(function(c){i.html(c),PIXL8.collapsible(i),f(b),i.find(".load-more-link").length&&a("a.load-more-link").loadMore()}).fail(function(){return alert("Connection failed, please try again later"),!1}).complete(function(){c(!1)})},f=function(b){a.ajax(h,{method:"POST",cache:!1,data:b}).done(function(a){p.html(a),PIXL8.cpdChart()}).fail(function(){return alert("Connection failed, please try again later"),!1})},j.on("change",".related-filter-field,.filter-checkbox",function(c){"cpd_date"==a(this).attr("name")&&(l.prop("checked",!1).trigger("change"),b()),c.preventDefault(),d()}),l.on("change",function(c){a(this).prop("checked")?a('input[name="cpd_date"]').prop("checked",!1):(b(),c.preventDefault(),d())}),j.on("dp.change",".date-filter",function(b){if(m.closest(".form-field").find(".alert").remove(),""!=m.val()&&""!=n.val()){new Date(n.val())>new Date(m.val())&&m.closest(".form-field").append(a(document.createElement("div")).text("Invalid date").addClass("alert alert-message alert-danger error"))}b.preventDefault(),d()}),j.on("click",".tag-close-btn",function(b){b.preventDefault();var c=a(this);a("[name='"+c.data("name")+"'][value='"+c.data("value")+"']").prop("checked",!1),d()}),j.on("click",".tag-close-btn-date",function(a){a.preventDefault(),d()})})}(jQuery);
//# sourceMappingURL=_cpd.min.map